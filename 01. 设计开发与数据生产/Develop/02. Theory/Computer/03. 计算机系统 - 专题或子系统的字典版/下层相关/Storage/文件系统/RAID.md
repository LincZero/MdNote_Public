# Raid (Redundant Arrays Of Independent Disks，独立磁盘冗余阵列)

参考：[什么是磁盘阵列？15种RAID优缺点详解 (RAID5 RAID6 RAID10 RAIDZ SHR UNRAID)](https://www.bilibili.com/video/BV1vA411W7yU)

## Raid分类

- 硬件 Raid
  - 磁盘阵列柜（特别贵）
  - Raid阵列卡，更快更稳定（有缓存和带电池，一定的数据保护。全新贵，二手便宜）
  - 其他，如主办RAID（天坑，不建议试）
- 软件 Raid
  - 民用Raid大多是软Raid

## 15种Raid磁盘阵列

### 传统Raid

| Raid阵列  | 速度/容量                        | 保护原理                                                     |                     |
| --------- | -------------------------------- | ------------------------------------------------------------ | ------------------- |
| **Raid0** | 直接叠加，**最快**，**最不安全** | 完全无                                                       | 坏一个盘全没        |
| **Raid1** | 等于单块，**最安全**，**最慢**   | 通过完全备份                                                 | 能只剩一个盘        |
| **Raid2** |                                  | 增加纠错码实时纠错，分开存储纠错码                           |                     |
| Raid3     |                                  | R2 Plus。纠错码单独放校验盘，但校验盘易坏                    | 不能坏校验盘        |
| Raid4     |                                  | R3 Plus。分块更大，小文件写入更快，缺点是更低的恢复概率      | 不能坏校验盘        |
| **Raid5** | 1/3空间冗余。应用最广泛          | RAID5缺点：碰到URE时容易重建数据，一块坏了容易导致其他也坏。<br />建议Raid不要用同一时间出厂的硬盘 | 一块坏了            |
| Raid6     |                                  | 安全性较Raid有较大提升                                       | 至少4块，两块校验盘 |
| Raid7     |                                  | 非标准Raid模式，专利归美国SCC公司                            |                     |

扩展：RAID F1，对SSD有优化。有自动故障转移

URE：不可恢复性读取错误，每12TB可能出现一个。

### 混合Raid

- Raid10 = Raid0 + Raid1，至少四块硬盘，缺点是总容量只有一半
  注意一般没有Raid01，原理是不同的。在扩展性、以及重建阵列都有所欠缺
  延伸一下，可以有Raid50、60
- JBOD模式，串联模式。优点：每次读写只用一个，缺点是安全性低
- UNRadi模式：带荣誉的JBOD，多了块校验盘。优点是扩展方便、空间大，缺点是要收费、写入慢
- 群辉SHR：就是根据硬盘数量和容量，能自动选择Raid模式。缺点：数据恢复要专用文件
- Raid Z：基于ZFS系统 (先进的128文件系统) 的软Raid，ZFS不需要任何额外软件或硬件就可以处理 Raid。ZFS系统带来的优秀功能：
  - 优点
    - 可以创建跨硬盘的存储空间
    - 当旧数据被覆盖,仍然可以找回
    - 跟踪文件更改，快照保留原始系统文件
    - 读取数据时进行校验，并自动尝试修复错误
  - 缺点
    - 内存占用大，每T最好对应1G内存，否则性能下降
    - 扩容不方便

## 视频评论

从业者说几句，给大家一点建议

1. RAID不是万能，RAID防以外不防。懒和白
   任何RAID的数据保护都是以维护作为前提的，就拿在B站我见一次就被黑一次的RAID来说，就特别需要维护，最少2周一次的VD检验吗是必须的，原因就是传统机械盘如果有坏块，如果不去读取，那么就不知道有怪快，时间长了就会出现的复数的怪快，如果这时候硬盘坏了，就会出现无法恢复的数据块，这个适用于所有所有类型的RAID，只是概率高低而已。所以RAID是需要定期检验的，目的就是发现这些坏掉的数据块并修复数据。所以说，不是做了RAID就高枕无忧的，你就算10块硬盘镜像也顶不住10块都坏了
2. 建议大家用RAID卡，原因很简单，用RAID卡的硬RAID，盘和卡绑定，万一你的存储系统或者主板坏了，你把卡和硬盘迁移到其他机器马上就能用，存储系统也建议windoes或者linux的系统，原因就前面说的，基本上所有硬件都能装windows或者linux基本不挑硬件
3. 就是RAID的硬盘不建议大家用太大的
   1. 原因1，就是单盘越大，空间损失越多
   2. 原因2就是单盘越大，重建时间越长，越容易出意外，
4. 最后就是千万别贪便宜用SMR硬盘，SMR硬盘写入性能非常糟糕，但是RADI重建是一个全盘写的过程，SMR确定会大大延长重建时间。RAID最脆弱的时候就是重建的时候，夜长梦多

最后总结，不要贸贸然就上RAID。RAID不是万能的。如果没了不懂得我前面说的那些。你还是定期多盘备份吧



同是从业者补充一小下，老的raid卡会有盘卡绑定现象，是因为raid信息在卡里，而不在硬盘里，所以不仅磁盘，卡的故障也会导致数据丢失。后来改成同时存在于两者内，碰到两者不符合的情况，比如更换卡，或者将磁盘组换到其他机器上时，需要手动确认启用并覆盖阵列信息，选错也是玩完。再之后raid信息存在磁盘头文件里，每次启动时阵列卡会读取并调用该信息，像楼上说的那个r720（已经很老的服务器了） 配的h710的上两代就是这样做的，所以现在卡和磁盘绑定基本上很少见到了。







