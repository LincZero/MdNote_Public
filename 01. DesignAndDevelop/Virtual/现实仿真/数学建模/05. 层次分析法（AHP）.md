# 数学建模

# 目录

# 层次分析法（AHP）

## 简概

### 简概

- 误区

  认为主观性太强，数据建模比赛用了就没办法得奖，国赛经常能获奖

- 历史

  > 层次分析法（AHP）是美国运筹学家匹茨堡大学教授萨蒂（T.L.Saaty）于上世纪70年代初，为美国国防部研究 “根据各个工业部门对国家福利的贡献大小而进行电力分配“ 课题时，应用网络系统理论和多目标综合评价方法，提出的一种层次权重决策分析方法。
  >
  > 特点是在对复杂的决策问题的本质、影响因素及其内在关系等进行深入分析的基础上，利用较少的定量信息使决策的思维过程数学化，从而为多目标、多准则或无结构特性的复杂决策问题提供简便的决策方法
  >
  > 是对难于完全定量的复杂系统作出决策的模型和方法

- 决策概念

  > 决策是指在面临多种方案时需要依据一定的标准选择某一种方案。日常生活中有许多决策问题。举例
  >
  > 1. 在海尔、新飞、容声和雪花四个牌号的电冰箱中选购一种
  >    要考虑品牌的信誉、冰箱的功能、价格和耗电量
  > 2. 在泰山、杭州和承德三处选择一个旅游点
  >    要考虑景点的景色、居住的环境、饮食的特色、交通便利和旅游的费用
  > 3. 在基础研究、应用研究和数学教育中选择一个领域申报科研课题
  >    要考虑成果的贡献（实用价值、科学意义），可行性(难度、周期和经费）和人才培养
  > 4. 在小丽、小美、小静中选择一个适合自己的女朋友
  >    要考虑基本颜值，身材比例、教育程度、家境情况、地域关系等

- 特点

  > 该方法将定量分析与定性分析结合起来
  >
  > 用决策者的经验判断各衡量目标能否实现的标准之间的相对重要程度，并合理地给出每个决策方案的每个标准的权数
  > 利用权数求出各方案的优劣次序，比较有效地应用于那些难以用定量方法解决的课题

- 应用

  - 用于最佳方案的选取（选择运动员、选择地址）
  - 用于评价类问题        （评价水质状况、评价环境）
  - 用于指标体系的优选（兼顾科学和效率）

### 基本原理

层次分析法根据问题的性质和要达到的总目标，将问题分解为不同的组成因素，

并按照因素间的相互关联影响以及隶属关系将因素按不同层次聚集组合，形成一个多层次的分析结构模型，

从而最终使问题归结为最低层（供决策的方案、措施等）相对于最高层（总目标）的相对重要权值的确定或相对优劣次序的排定

### 优缺点分析

[此略]，详见视频

## 基本流程

### 基本步骤

1. 建立层次结构模型
2. 构造判断（对比比较）矩阵
3. 层次单排序及其一致性检验
4. 层次总排序及其一致性检验

### (1) 建立层次结构模型

#### 简概

将决策的目标、考虑的因素（决策准则）和决策对象按它们之间的相互关系分为最高层、中间层和最低层，绘出层次结构图

> | 最高层 | 目标层                             | 决策的目的、要解决的问题 |
> | ------ | ---------------------------------- | ------------------------ |
> | 中间层 | 因素层/准则层/指标层/策略层/约束层 | 考虑的因素、决策的准则   |
> | 最低层 | 方案层/地基层                      | 决策时的备选方案         |

对于相邻的两层，称高层为目标层，低层为因素层

层次分析法要解决的问题是关于最底层对最高层的相对权重问题

#### 举例：大学毕业生就业选择问题

获得大学毕业学位的毕业生，在“双向选择”时，用人单位与毕业生都有各自的选择标淮和要求。就毕业生来说选择单位的标准和要求是多方面的，例如：
1. 能发挥自己才干作出较好贡献（即工作岗位适合发挥自己的专长）
2. 工作收入较好                           （待遇好）
3. 生活环境好                               （大城市、气候等工作条件等）
4. 单位名声好                               （声誉等）
5. 工作环境好                               （人际关系和谐等)
6. 发展晋升机会多                       （如新单位或前景好等）

分层

- 目标层：工作选择
- 准则层：贡献、收入、发展、声誉、工作环境、生活环境
- 方案层：可供选择的单位 P1, P2, ......, Pn

#### 举例：选择女朋友

分层

- 目标层：找对象
- 准则层：颜值、身材、学历、家境、地域
- 方案层：小丽、小美、小静

#### 举例：选择旅游地

分层

- 目标层：选择旅游地
- 准则层：景色、费用、居住、饮食、旅途
- 方案层：桂林、黄山、北戴河

### (2) 构造判断矩阵（对比比较矩阵）

#### 简概

在确定各层次各因素之间的权重时，如果只是定性的结果，则常常不容易被别人接受，因而Santy等人提出：一致矩阵法，即:

1. 不把所有因素放在一起比较，而是两两相互比较
2. 对此时采用相对尺度，以尽可能减少性质不同的诸因素相互比较的困难，以提高准确度

判断矩阵是表示本层所有因素针对上一层某一个因素的相对重要性的比较。判断矩阵的元素$a_{ij}$用Santy的1—9标度方法给出

> 心理学家认为成对比较的因素不宜超过9个，即每层不要超过9个因素



判断矩阵元素$a_{ij}$的标度方法

| 标度    | 含义                                                         |
| ------- | ------------------------------------------------------------ |
| 1       | 表示两个因素相比，具有同样的重要性                           |
| 3       | 表示两个因素相比，一个因素比另一个因素**稍微重要**           |
| 5       | 表示两个因素相比，一个因素比另一个因素**明显重要**           |
| 7       | 表示两个因素相比，一个因素比另一个因素**强烈重要**           |
| 9       | 表示两个因素相比，一个因素比另一个因素**极端重要**           |
| 2,4,6,8 | 上述两相邻判断的中值                                         |
| 倒数    | 因素 i 与 j 比较的判断$a_{ij}$，则因素 j 与 i 比较的判断$a_{ji}=1/a_{ij}$ |

#### `判断矩阵`特性

`判断矩阵`，也称`对比比较矩阵`

- $A\sim$成对比较矩阵

- $A$是正互反矩阵

- 一致性检验

  - 一致性含义

    成对比较可以不一致，如第一行和第二行的C1和C3的比较 (比) 不一致
    允许不一致，但要确定不一致的允许范围
    当**完全一致**时，即满足$a_{ij}\cdot a_{jk}=a_{ik}$的正反矩阵$A$称为`一致阵`

  - 一致阵性质

    - $A$的秩为1，$A$的唯一非零特征根为$n$，$Aw=nw$

    - 非零特征根$n$所对应的特征向量归一化后可作为权向量

  - 一致性检验

    - 对于不一致（但在允许范围内）的成对比较阵A，Saaty等人建议用对应于最大特征根$\lambda$的特征向量作为权向量$w$，即$Aw=nw$
    - 这里得看下一步 —— 一致性检验

#### 举例：选择旅游地

分层

- 目标层：选择旅游地
- 准则层：景色、费用、居住、饮食、旅途
- 方案层：桂林、黄山、北戴河

判断矩阵
$$
~~~~~~~~~\begin{matrix}
C_1&C_2&C_3&C_4&C_5
\end{matrix}\\~\\
A=\begin{bmatrix}
~1~&~\frac12~&~4~&~3~&~3~\\
2&1&7&5&5\\
\frac14&\frac17&1&\frac12&\frac13\\
\frac13&\frac15&2&1&1\\
\frac13&\frac15&3&1&1
\end{bmatrix}
$$
### (3) 层次单排序及其一致性检验

本章要求学习到线性代数的 “特征根”

#### 简概与原理

- 层次单排序

  > 对应于判断矩阵最大特征根$\lambda_{\max}$的特征向量，经归一化（使向量中各元素之和等于1）后记为W
  >
  > W的元素为同一层次因素对于上一层次因素某因素相对重要性的排序权值，这一过程称为`层次单排序`
- 一致性检验

  > 能否确认层次单排序，需要进行一致性检验，所谓一致性检验是指对A确定不一致的允许范围
  >
  > （不要求完全一致，但要在不一致的允许范围中）

- 一致性指标原理

  > 由于入连续的依赖于$a_{ij}$，则$a_{ij}$比n大的越多，A的不一致性越严重
  >
  > 用最大特征值对应的特征向量作为被比较因素对上层某因素影响程度的权向量，其不一致程度越大，引起的判断误差越大
  >
  > 因而可以用a-n数值的大小来衡量A的不一致程度
  >
  > 
  >
  > 一致性检验：就是用一致性指标和一致性比率<0.1及随机一致性指标的数值表，对A进行检验的过程

#### 一致性检验

- `一致性指标`

  - 定理：n阶`一致阵`的唯一非零特征根为n
  - 定理：n阶正互反阵A的最大特征根$\lambda\geq n$，当且仅当$\lambda=n$时A为`一致阵`
  - 一致性指标：$CI=\frac{\lambda-n}{n-1}$
    - $CI=0$，有完全的一致性
    - $CI$接近于0，有满意的一致性
    - $CI$越大，不一致越严重

- `随机一致性指标`

  为衡量CI的大小，引入随机一致性指标RI

  方法为随机构造500个成对比较矩阵$A_1,A_2,\cdots,A_{500}$

  则可得一致性指标$CI_1,CI_2,\cdots,CI_{500}$
  $$
  RI=\frac{CI_1+CI_2+\cdots+CI_{500}}{500}=\frac{\frac{\lambda_1+\lambda_2+\cdots+\lambda_{500}}{500}-n}{n-1}
  $$
  Saaty的结果如下

  随机一致性指标RI

  | n    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   |
  | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
  | RI   | 0    | 0    | 0.58 | 0.90 | 1.12 | 1.24 | 1.32 | 1.41 | 1.45 | 1.49 | 1.51 |

- `一致性比率`

  一般当一致性比率$CR=\frac{CI}{RI}<0.1$时，认为A的不一致程度在容许范围内，有满意的一致性，通过一致性检验，可用其归一化特征向量作为权向量

  否则要重新构造成对比较矩阵A，对$a_{ij}$加以调整。

#### 举例：选择旅游地

原始计算

- 成对比矩阵
  $$
  A=\begin{bmatrix}
  1&\frac12&4&3&3\\
  2&1&7&5&5\\
  \frac14&\frac17&1&\frac12&\frac13\\
  \frac13&\frac15&2&1&1\\
  \frac13&\frac15&3&1&1
  \end{bmatrix}
  $$

- 最大特征根：$\lambda=5.073$，Matlab中`eij(A)`即可求得

- 权向量（特征向量）：$w=(0.263,0.475,0.055,0.090,0.110)^T$

- 一致性指标：$CI=\frac{5.073-5}{5-1}=0.018$

- 随机一致性指标：$RI=1.12（查表）$

- 一致性比率：$CR=0.018/0.12=0.016<0.1$

- 结论：通过一致性检验

---

简化计算（接近一致阵的才能用，正互反矩阵最大特征根和特征向量的简化计算）

- `一致阵`的任一列向量都是特征向量

- 一致性尚好的正互反阵的列向量都应近似特征向量，可取其某种意义下的平均——和法，取列向量的算术平均

- 例
  $$
  A=\begin{bmatrix}
      1&2&6\\
      \frac12&1&4\\
      \frac16&\frac14&1
  \end{bmatrix}
  \xrightarrow{列向量归一化}\begin{bmatrix}
      0.6&0.615&0.545\\
      0.3&0.308&0.364\\
      0.1&0.077&0.091
  \end{bmatrix}
  \xrightarrow{求行和归一化}\begin{bmatrix}
      0.587\\
      0.324\\
      0.089
  \end{bmatrix}=w\\~\\
  Aw=\begin{bmatrix}
      1.769\\
      0.974\\
      0.0268
  \end{bmatrix}
  \xrightarrow{Aw=\lambda w}\lambda=\frac13(\frac{1.769}{0.587}+\frac{0.974}{0.324}+\frac{0.268}{0.089})=3.009~~~~~~~~~~~~~~~~~~~~~\\~\\
  精确结果：w=(0.588,0.322,0.090)^T，\lambda=3.010
  $$

### (4) 层次总排序及其一致性检验

#### 层次总排序

- 计算某一层次所有因素对于最高层（总目标）相对重要性的权值，称为`层次总排序`

- 这一过程是从最高层次到最低层次依次进行的

- 层次总排序的一致性比率
  $$
  CR=\frac{a_1CI_1+a_2CI_2+\cdots+a_mCI_m}{a_1RI_1+a_2RI_2+\cdots+a_mRI_m}
  $$
  当$CR<0.1$时，认为层次总排序通过一致性检验，否则需要重新调整

#### 举例：选择旅游地

- 记第二层（准则）对第一次（目标）的权向量为$w^{(2)}=(0.263,0.475,0.055,0.090,0.110)^T$

- 同理，第三册（方案）对第二层每一元素（准则）的权向量

  - 方案层对$C_1$（景色）的成对比较矩阵
    $$
    B_1=\begin{bmatrix}
    1&2&5\\
    \frac12&1&2\\
    \frac15&\frac12&1
    \end{bmatrix}
    $$

  - 方案层对$C_2$（费用）的成对比较矩阵
    $$
    B_2=\begin{bmatrix}
    1&\frac13&\frac18\\
    3&1&\frac13\\
    8&3&1
    \end{bmatrix}
    $$

  - ......

- 最大特征根：$\lambda_1=3.005，\lambda_2=3.002，\cdots$

- 权向量：$w_1^{(3)}=(0.595,0.277,0.129)，w_2^{(3)}=(0.082,0.236,0.682)，\cdots$

- 第三层对第二层的计算结果

  > |  $w^{(2)}$  |            0.263            |            0.475            |            0.055            |            0.090            |            0.110             |
  > | :---------: | :-------------------------: | :-------------------------: | :-------------------------: | :-------------------------: | :--------------------------: |
  > | $w_k^{(3)}$ | 0.595<br />0.277<br />0.129 | 0.082<br />0.236<br />0.682 | 0.429<br />0.429<br />0.142 | 0.633<br />0.193<br />0.175 | 0.166<br />0.166<br />0.6680 |
  > | $\lambda_k$ |            3.005            |            3.002            |              3              |            3.009            |              3               |
  > |   $CI_k$    |            0.003            |            0.001            |              0              |            0.005            |              0               |

- 结论：$RI=0.58（n=3查表）$，$CI_k$均可通过一致性检验

  方案P1对目标的组合权重为$0.595\times0.263+\cdots=0.300$

  方案层对目标层的组合权向量为$(0.300,0.246,0.456)^T$

  即方案3的得分最高

## 编程实现和数学建模

略，详见视频















